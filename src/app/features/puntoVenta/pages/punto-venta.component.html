<div class="container-fluid mt-4">
    <div class="card">
      <div class="card-header bg-light">
        <h4 class="mb-0">PUNTO DE VENTA (POS)</h4>
      </div>
      <div class="card-body">
        
        <!-- Formulario para agregar productos -->
        <form [formGroup]="formularioProducto" (ngSubmit)="registrarProducto()" class="mb-4">
          <div class="row g-3 align-items-end">
            <div class="col-md-4">
              <input 
                type="text" 
                class="form-control" 
                placeholder="Nombre del producto..." 
                formControlName="nombreProducto"
                [readonly]="editandoProducto !== null">
            </div>
            <div class="col-md-2">
              <input 
                type="number" 
                class="form-control" 
                placeholder="Cant" 
                formControlName="cantidad"
                min="1">
            </div>
            <div class="col-md-3">
              <input 
                type="number" 
                class="form-control" 
                placeholder="$ Precio U." 
                formControlName="precioUnitario"
                step="0.01"
                min="0.01"
                [readonly]="editandoProducto !== null">
            </div>
            <div class="col-md-3">
              <button 
                type="submit" 
                class="btn btn-success me-2"
                [disabled]="formularioProducto.invalid">
                <i class="fas fa-plus"></i> {{ editandoProducto ? 'Actualizar' : 'Registrar' }}
              </button>
              <button 
                type="button" 
                class="btn btn-secondary"
                *ngIf="editandoProducto"
                (click)="cancelarEdicion()">
                Cancelar
              </button>
            </div>
          </div>
        </form>
  
        <!-- Tabla de productos -->
        <div class="table-responsive">
          <table class="table table-striped table-hover">
            <thead class="table-light">
              <tr>
                <th>Cns</th>
                <th>Nombre del Producto</th>
                <th>Precio U.</th>
                <th>Cant.</th>
                <th>Precio P.</th>
                <th>Acciones</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let producto of productos" [class.table-warning]="editandoProducto === producto.cns">
                <td>{{ producto.cns }}</td>
                <td>{{ producto.nombreProducto }}</td>
                <td>${{ producto.precioUnitario | number:'1.2-2' }}</td>
                <td>{{ producto.cantidad }}</td>
                <td>${{ producto.precioTotal | number:'1.2-2' }}</td>
                <td>
                  <button 
                    class="btn btn-sm btn-success me-1" 
                    (click)="editarProducto(producto.cns)"
                    [disabled]="editandoProducto !== null">
                    <i class="fas fa-edit"></i>
                  </button>
                  <button 
                    class="btn btn-sm btn-danger" 
                    (click)="eliminarProducto(producto.cns)"
                    [disabled]="editandoProducto !== null">
                    <i class="fas fa-trash"></i>
                  </button>
                </td>
              </tr>
              <tr *ngIf="productos.length === 0">
                <td colspan="6" class="text-center text-muted">
                  No hay productos registrados
                </td>
              </tr>
            </tbody>
          </table>
        </div>
  
        <!-- PaginaciÃ³n info -->
        <div class="d-flex justify-content-between align-items-center mb-3">
          <div class="pagination-info">
            <span class="text-muted">Visualizando {{ productos.length }} de {{ productos.length }} productos</span>
          </div>
        </div>
  
        <!-- Totales -->
        <div class="row justify-content-end">
          <div class="col-md-6">
            <div class="card">
              <div class="card-body">
                <div class="row mb-2">
                  <div class="col-6"><strong>Subtotal:</strong></div>
                  <div class="col-6 text-end">${{ totales.subtotal | number:'1.2-2' }}</div>
                </div>
                <div class="row mb-2">
                  <div class="col-6"><strong>IVA (16%):</strong></div>
                  <div class="col-6 text-end">${{ totales.iva | number:'1.2-2' }}</div>
                </div>
                <hr>
                <div class="row">
                  <div class="col-6"><strong>Total:</strong></div>
                  <div class="col-6 text-end"><strong>${{ totales.total | number:'1.2-2' }}</strong></div>
                </div>
              </div>
            </div>
          </div>
        </div>
  
      </div>
    </div>
  </div>